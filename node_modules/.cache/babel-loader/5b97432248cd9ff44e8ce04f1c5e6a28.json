{"remainingRequest":"F:\\Webstromfiles\\录播课程\\VUE2\\入门\\搭建工程\\my-cite\\node_modules\\babel-loader\\lib\\index.js!F:\\Webstromfiles\\录播课程\\VUE2\\入门\\搭建工程\\my-cite\\src\\directive\\lazy.js","dependencies":[{"path":"F:\\Webstromfiles\\录播课程\\VUE2\\入门\\搭建工程\\my-cite\\src\\directive\\lazy.js","mtime":1618312029651},{"path":"F:\\Webstromfiles\\录播课程\\VUE2\\入门\\搭建工程\\my-cite\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Webstromfiles\\录播课程\\VUE2\\入门\\搭建工程\\my-cite\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIkY6L1dlYnN0cm9tZmlsZXMvXHU1RjU1XHU2NEFEXHU4QkZFXHU3QTBCL1ZVRTIvXHU1MTY1XHU5NUU4L1x1NjQyRFx1NUVGQVx1NURFNVx1N0EwQi9teS1jaXRlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0IGV2ZW50QnVzIGZyb20gIkAvZXZlbnRCdXMiOwppbXBvcnQgeyBkZWJvdW5jZSB9IGZyb20gIkAvdXRpbHMiOwppbXBvcnQgZGVmYXVsdEdpZiBmcm9tICJAL2Fzc2V0cy92bGF6eS1pbWcvZGVmYXVsdC5naWYiOwp2YXIgaW1ncyA9IFtdOwoKZnVuY3Rpb24gc2V0SW1hZ2UoaW1nKSB7CiAgaW1nLmRvbS5zcmMgPSBkZWZhdWx0R2lmOyAvL+WFiOaaguaXtuS9v+eUqOm7mOiupOWbvueJhwogIC8v5aSE55CG5Zu+54mHCiAgLy/or6Xlm77niYfmmK/lkKblnKjop4blj6PojIPlm7TlhoUKCiAgdmFyIGNsaWVudEhlaWdodCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQ7CiAgdmFyIHJlY3QgPSBpbWcuZG9tLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogIHZhciBoZWlnaHQgPSAwOwoKICBpZiAocmVjdC50b3AgPj0gaGVpZ2h0ICYmIHJlY3QudG9wIDw9IGNsaWVudEhlaWdodCkgewogICAgLy/lnKjop4blj6PojIPlm7TlhoUKICAgIHZhciB0ZW1wSW1nID0gbmV3IEltYWdlKCk7CgogICAgdGVtcEltZy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGltZy5kb20uc3JjID0gaW1nLnNyYzsKICAgIH07CgogICAgdGVtcEltZy5zcmMgPSBpbWcuc3JjOwogICAgaW1ncyA9IGltZ3MuZmlsdGVyKGZ1bmN0aW9uIChpKSB7CiAgICAgIHJldHVybiBpICE9PSBpbWc7CiAgICB9KTsKICB9Cn0gLy/luIzmnJvosIPnlKjor6Xlh73mlbDvvIzlsLHlj6/ku6Xorr7nva7pgqPkupvlkIjpgILnmoTlm77niYcKCgpmdW5jdGlvbiBzZXRJbWFnZXMoKSB7CiAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGltZ3MpLAogICAgICBfc3RlcDsKCiAgdHJ5IHsKICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgIHZhciBpbWcgPSBfc3RlcC52YWx1ZTsKICAgICAgc2V0SW1hZ2UoaW1nKTsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9pdGVyYXRvci5lKGVycik7CiAgfSBmaW5hbGx5IHsKICAgIF9pdGVyYXRvci5mKCk7CiAgfQp9CgpmdW5jdGlvbiBoYW5kbGVTY3JvbGwoZG9tKSB7CiAgc2V0SW1hZ2VzKCk7Cn0KCmV2ZW50QnVzLiRvbigibWFpblNjcm9sbCIsIGRlYm91bmNlKGhhbmRsZVNjcm9sbCwgMTAwKSk7CmV4cG9ydCBkZWZhdWx0IHsKICBpbnNlcnRlZDogZnVuY3Rpb24gaW5zZXJ0ZWQoZWwsIGJpbmRpbmdzKSB7CiAgICB2YXIgaW1nID0gewogICAgICBkb206IGVsLAogICAgICBzcmM6IGJpbmRpbmdzLnZhbHVlCiAgICB9OwogICAgaW1ncy5wdXNoKGltZyk7IC8v56uL5Y2z5aSE55CG5a6DCgogICAgc2V0SW1hZ2UoaW1nKTsKICB9LAogIHVuYmluZDogZnVuY3Rpb24gdW5iaW5kKGVsKSB7CiAgICBpbWdzID0gaW1ncy5maWx0ZXIoZnVuY3Rpb24gKGltZykgewogICAgICByZXR1cm4gaW1nLmRvbSAhPT0gZWw7CiAgICB9KTsKICB9Cn07"},{"version":3,"sources":["F:/Webstromfiles/录播课程/VUE2/入门/搭建工程/my-cite/src/directive/lazy.js"],"names":["eventBus","debounce","defaultGif","imgs","setImage","img","dom","src","clientHeight","document","documentElement","rect","getBoundingClientRect","height","top","tempImg","Image","onload","filter","i","setImages","handleScroll","$on","inserted","el","bindings","value","push","unbind"],"mappings":";;AAAA,OAAOA,QAAP,MAAqB,YAArB;AACA,SAASC,QAAT,QAAyB,SAAzB;AACA,OAAOC,UAAP,MAAuB,gCAAvB;AAEA,IAAIC,IAAI,GAAG,EAAX;;AAEA,SAASC,QAAT,CAAkBC,GAAlB,EAAsB;AAClBA,EAAAA,GAAG,CAACC,GAAJ,CAAQC,GAAR,GAAcL,UAAd,CADkB,CACO;AACzB;AACA;;AACA,MAAMM,YAAY,GAAGC,QAAQ,CAACC,eAAT,CAAyBF,YAA9C;AACA,MAAMG,IAAI,GAAGN,GAAG,CAACC,GAAJ,CAAQM,qBAAR,EAAb;AACA,MAAMC,MAAM,GAAG,CAAf;;AACA,MAAGF,IAAI,CAACG,GAAL,IAAYD,MAAZ,IAAsBF,IAAI,CAACG,GAAL,IAAYN,YAArC,EAAkD;AAC9C;AACA,QAAMO,OAAO,GAAG,IAAIC,KAAJ,EAAhB;;AACAD,IAAAA,OAAO,CAACE,MAAR,GAAiB,YAAU;AACvBZ,MAAAA,GAAG,CAACC,GAAJ,CAAQC,GAAR,GAAcF,GAAG,CAACE,GAAlB;AACH,KAFD;;AAGAQ,IAAAA,OAAO,CAACR,GAAR,GAAcF,GAAG,CAACE,GAAlB;AACAJ,IAAAA,IAAI,GAAGA,IAAI,CAACe,MAAL,CAAY,UAACC,CAAD;AAAA,aAAOA,CAAC,KAAKd,GAAb;AAAA,KAAZ,CAAP;AACH;AACJ,C,CAED;;;AACA,SAASe,SAAT,GAAoB;AAAA,6CACEjB,IADF;AAAA;;AAAA;AAChB,wDAAwB;AAAA,UAAbE,GAAa;AACpBD,MAAAA,QAAQ,CAACC,GAAD,CAAR;AACH;AAHe;AAAA;AAAA;AAAA;AAAA;AAInB;;AAED,SAASgB,YAAT,CAAsBf,GAAtB,EAA0B;AACtBc,EAAAA,SAAS;AACZ;;AAEDpB,QAAQ,CAACsB,GAAT,CAAa,YAAb,EAA2BrB,QAAQ,CAACoB,YAAD,EAAe,GAAf,CAAnC;AAEA,eAAe;AACXE,EAAAA,QADW,oBACFC,EADE,EACEC,QADF,EACW;AAClB,QAAMpB,GAAG,GAAG;AACRC,MAAAA,GAAG,EAAEkB,EADG;AAERjB,MAAAA,GAAG,EAAEkB,QAAQ,CAACC;AAFN,KAAZ;AAIAvB,IAAAA,IAAI,CAACwB,IAAL,CAAUtB,GAAV,EALkB,CAMlB;;AACAD,IAAAA,QAAQ,CAACC,GAAD,CAAR;AACH,GATU;AAUXuB,EAAAA,MAVW,kBAUJJ,EAVI,EAUD;AACNrB,IAAAA,IAAI,GAAGA,IAAI,CAACe,MAAL,CAAY,UAAAb,GAAG,EAAI;AACtB,aAAOA,GAAG,CAACC,GAAJ,KAAYkB,EAAnB;AACH,KAFM,CAAP;AAGH;AAdU,CAAf","sourcesContent":["import eventBus from \"@/eventBus\";\r\nimport { debounce } from \"@/utils\";\r\nimport defaultGif from \"@/assets/vlazy-img/default.gif\"\r\n\r\nlet imgs = [];\r\n\r\nfunction setImage(img){\r\n    img.dom.src = defaultGif;//先暂时使用默认图片\r\n    //处理图片\r\n    //该图片是否在视口范围内\r\n    const clientHeight = document.documentElement.clientHeight;\r\n    const rect = img.dom.getBoundingClientRect();\r\n    const height = 0;\r\n    if(rect.top >= height && rect.top <= clientHeight){\r\n        //在视口范围内\r\n        const tempImg = new Image();\r\n        tempImg.onload = function(){\r\n            img.dom.src = img.src;\r\n        };\r\n        tempImg.src = img.src;\r\n        imgs = imgs.filter((i) => i !== img);\r\n    }\r\n}\r\n\r\n//希望调用该函数，就可以设置那些合适的图片\r\nfunction setImages(){\r\n    for (const img of imgs) {\r\n        setImage(img);\r\n    }\r\n}\r\n\r\nfunction handleScroll(dom){\r\n    setImages();\r\n}\r\n\r\neventBus.$on(\"mainScroll\", debounce(handleScroll, 100));\r\n\r\nexport default {\r\n    inserted(el, bindings){\r\n        const img = {\r\n            dom: el,\r\n            src: bindings.value,\r\n        }\r\n        imgs.push(img);\r\n        //立即处理它\r\n        setImage(img);\r\n    },\r\n    unbind(el){\r\n        imgs = imgs.filter(img => {\r\n            return img.dom !== el\r\n        })\r\n    }\r\n}"]}]}